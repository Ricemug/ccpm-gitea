# 命令

**[English Documentation](../en/COMMANDS.md)** | **[繁体中文文档](../zh-tw/COMMANDS.md)**

Claude Code PM 系统中所有可用命令的完整参考。

> **注意**：项目管理命令（`/pm:*`）在主要的 [README.md](README.md#命令参考) 中有文件说明。

## 目录

- [上下文命令](#上下文命令)
- [测试命令](#测试命令)
- [工具命令](#工具命令)
- [审查命令](#审查命令)

## 上下文命令

用于管理 `.claude/context/` 中项目上下文的命令。

### `/context:create`
- **用途**：建立初始项目上下文文件
- **使用方式**：`/context:create`
- **说明**：分析项目结构并在 `.claude/context/` 中建立全面的基准文件。包含项目概述、架构、依赖性和模式。
- **使用时机**：项目开始时或当上下文需要完全重建时
- **输出**：涵盖项目不同面向的多个上下文档案

### `/context:update`
- **用途**：使用最近的变更更新现有上下文
- **使用方式**：`/context:update`
- **说明**：根据最近的程序代码变更、新功能或架构更新来刷新上下文文件。在新增新信息的同时保留现有上下文。
- **使用时机**：重大变更后或重要工作阶段之前
- **输出**：带有变更追踪的更新上下文档案

### `/context:prime`
- **用途**：将上下文载入到当前对话中
- **使用方式**：`/context:prime`
- **说明**：读取所有上下文档案并将它们载入到当前对话的记忆中。对于维持项目感知至关重要。
- **使用时机**：任何工作阶段开始时
- **输出**：已载入上下文的确认讯息

## 测试命令

用于测试配置和执行的命令。

### `/testing:prime`
- **用途**：配置测试设定
- **使用方式**：`/testing:prime`
- **说明**：侦测并配置项目的测试框架，建立测试配置，并准备 test-runner 代理。
- **使用时机**：初始项目设定或测试框架变更时
- **输出**：包含测试命令和模式的 `.claude/testing-config.md`

### `/testing:run`
- **用途**：执行智能分析的测试
- **使用方式**：`/testing:run [test_target]`
- **说明**：使用 test-runner 代理执行测试，该代理会将输出捕获到日志中，并仅返回必要结果以保留上下文。
- **选项**：
   - 无参数：执行所有测试
   - 档案路径：执行特定测试档案
   - 模式：执行符合模式的测试
- **输出**：包含已分析失败的测试摘要，主执行绪中无详细输出

## 工具命令

一般工具和维护命令。

### `/prompt`
- **用途**：处理具有多个引用的复杂提示
- **使用方式**：将提示写入档案，然后输入 `/prompt`
- **说明**：当具有大量 @ 引用的复杂提示在直接输入时失败的临时命令。先将提示写入命令档案，然后执行。
- **使用时机**：当 Claude 的 UI 拒绝复杂提示时
- **输出**：执行已写入的提示

### `/re-init`
- **用途**：使用 PM 规则更新或建立 CLAUDE.md
- **使用方式**：`/re-init`
- **说明**：使用 `.claude/CLAUDE.md` 中的规则更新项目的 CLAUDE.md 档案，确保 Claude 实例具有正确的指示。
- **使用时机**：复制 PM 系统后或更新规则后
- **输出**：项目根目录中更新的 CLAUDE.md

## 审查命令

用于处理外部程序代码审查工具的命令。

### `/code-rabbit`
- **用途**：智能处理 CodeRabbit 审查评论
- **使用方式**：`/code-rabbit` 然后贴上评论
- **说明**：根据上下文感知评估 CodeRabbit 建议，接受有效的改进，同时忽略缺乏上下文感知的建议。为多档案审查生成并行代理。
- **功能**：
   - 理解 CodeRabbit 缺少完整上下文
   - 接受：真正的错误、安全问题、资源泄漏
   - 忽略：样式偏好、不相关的模式
   - 多个档案的并行处理
- **输出**：已接受/已忽略建议的摘要及其理由

## 命令模式

所有命令都遵循一致的模式：

### 允许的工具
每个命令在前言中指定其所需的工具：
- `Read, Write, LS` - 档案操作
- `Bash` - 系统命令
- `Task` - 子代理生成
- `Grep` - 程序代码搜寻

### 错误处理
命令遵循快速失败原则：
- 首先检查先决条件
- 清晰的错误讯息及解决方案
- 永不留下部分状态

### 上下文保留
处理大量信息的命令：
- 使用代理保护主执行绪免受详细输出影响
- 返回摘要，而非原始数据
- 仅保留必要信息

## 建立自定义命令

要新增新命令：

1. **建立档案**：`commands/category/command-name.md`
2. **新增前言**：
   ```yaml
   ---
   allowed-tools: Read, Write, LS
   ---
   ```
3. **组织内容**：
   - 用途和使用方式
   - 飞行前检查
   - 逐步说明
   - 错误处理
   - 输出格式

4. **遵循模式**：
   - 保持简单（无过度验证）
   - 使用清晰讯息快速失败
   - 使用代理处理繁重处理
   - 返回简洁输出

## 与代理整合

命令经常使用代理进行繁重工作：

- **test-runner**：执行测试，分析结果
- **file-analyzer**：摘要详细档案
- **code-analyzer**：在程序代码库中寻找错误
- **parallel-worker**：协调并行执行

这样可以保持主对话上下文干净，同时执行复杂的工作。

## 注意事项

- 命令是作为指示解释的 markdown 档案
- `/` 前缀触发命令执行
- 命令可以生成代理以保留上下文
- 所有 PM 命令（`/pm:*`）在主要 README 中有文件说明
- 命令遵循 `/rules/` 中定义的规则
