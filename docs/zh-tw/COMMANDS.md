# 命令

**[English Documentation](../en/COMMANDS.md)** | **[簡體中文文檔](../zh-cn/COMMANDS.md)**

Claude Code PM 系統中所有可用命令的完整參考。

> **注意**：專案管理命令（`/pm:*`）在主要的 [README.md](README.md#命令參考) 中有文件說明。

## 目錄

- [上下文命令](#上下文命令)
- [測試命令](#測試命令)
- [工具命令](#工具命令)
- [審查命令](#審查命令)

## 上下文命令

用於管理 `.claude/context/` 中專案上下文的命令。

### `/context:create`
- **用途**：建立初始專案上下文文件
- **使用方式**：`/context:create`
- **說明**：分析專案結構並在 `.claude/context/` 中建立全面的基準文件。包含專案概述、架構、相依性和模式。
- **使用時機**：專案開始時或當上下文需要完全重建時
- **輸出**：涵蓋專案不同面向的多個上下文檔案

### `/context:update`
- **用途**：使用最近的變更更新現有上下文
- **使用方式**：`/context:update`
- **說明**：根據最近的程式碼變更、新功能或架構更新來刷新上下文文件。在新增新資訊的同時保留現有上下文。
- **使用時機**：重大變更後或重要工作階段之前
- **輸出**：帶有變更追蹤的更新上下文檔案

### `/context:prime`
- **用途**：將上下文載入到當前對話中
- **使用方式**：`/context:prime`
- **說明**：讀取所有上下文檔案並將它們載入到當前對話的記憶中。對於維持專案感知至關重要。
- **使用時機**：任何工作階段開始時
- **輸出**：已載入上下文的確認訊息

## 測試命令

用於測試配置和執行的命令。

### `/testing:prime`
- **用途**：配置測試設定
- **使用方式**：`/testing:prime`
- **說明**：偵測並配置專案的測試框架，建立測試配置，並準備 test-runner 代理。
- **使用時機**：初始專案設定或測試框架變更時
- **輸出**：包含測試命令和模式的 `.claude/testing-config.md`

### `/testing:run`
- **用途**：執行智慧分析的測試
- **使用方式**：`/testing:run [test_target]`
- **說明**：使用 test-runner 代理執行測試，該代理會將輸出捕獲到日誌中，並僅返回必要結果以保留上下文。
- **選項**：
   - 無參數：執行所有測試
   - 檔案路徑：執行特定測試檔案
   - 模式：執行符合模式的測試
- **輸出**：包含已分析失敗的測試摘要，主執行緒中無詳細輸出

## 工具命令

一般工具和維護命令。

### `/prompt`
- **用途**：處理具有多個引用的複雜提示
- **使用方式**：將提示寫入檔案，然後輸入 `/prompt`
- **說明**：當具有大量 @ 引用的複雜提示在直接輸入時失敗的臨時命令。先將提示寫入命令檔案，然後執行。
- **使用時機**：當 Claude 的 UI 拒絕複雜提示時
- **輸出**：執行已寫入的提示

### `/re-init`
- **用途**：使用 PM 規則更新或建立 CLAUDE.md
- **使用方式**：`/re-init`
- **說明**：使用 `.claude/CLAUDE.md` 中的規則更新專案的 CLAUDE.md 檔案，確保 Claude 實例具有正確的指示。
- **使用時機**：複製 PM 系統後或更新規則後
- **輸出**：專案根目錄中更新的 CLAUDE.md

## 審查命令

用於處理外部程式碼審查工具的命令。

### `/code-rabbit`
- **用途**：智慧處理 CodeRabbit 審查評論
- **使用方式**：`/code-rabbit` 然後貼上評論
- **說明**：根據上下文感知評估 CodeRabbit 建議，接受有效的改進，同時忽略缺乏上下文感知的建議。為多檔案審查生成並行代理。
- **功能**：
   - 理解 CodeRabbit 缺少完整上下文
   - 接受：真正的錯誤、安全問題、資源洩漏
   - 忽略：樣式偏好、不相關的模式
   - 多個檔案的並行處理
- **輸出**：已接受/已忽略建議的摘要及其理由

## 命令模式

所有命令都遵循一致的模式：

### 允許的工具
每個命令在前言中指定其所需的工具：
- `Read, Write, LS` - 檔案操作
- `Bash` - 系統命令
- `Task` - 子代理生成
- `Grep` - 程式碼搜尋

### 錯誤處理
命令遵循快速失敗原則：
- 首先檢查先決條件
- 清晰的錯誤訊息及解決方案
- 永不留下部分狀態

### 上下文保留
處理大量資訊的命令：
- 使用代理保護主執行緒免受詳細輸出影響
- 返回摘要，而非原始資料
- 僅保留必要資訊

## 建立自訂命令

要新增新命令：

1. **建立檔案**：`commands/category/command-name.md`
2. **新增前言**：
   ```yaml
   ---
   allowed-tools: Read, Write, LS
   ---
   ```
3. **組織內容**：
   - 用途和使用方式
   - 飛行前檢查
   - 逐步說明
   - 錯誤處理
   - 輸出格式

4. **遵循模式**：
   - 保持簡單（無過度驗證）
   - 使用清晰訊息快速失敗
   - 使用代理處理繁重處理
   - 返回簡潔輸出

## 與代理整合

命令經常使用代理進行繁重工作：

- **test-runner**：執行測試，分析結果
- **file-analyzer**：摘要詳細檔案
- **code-analyzer**：在程式碼庫中尋找錯誤
- **parallel-worker**：協調並行執行

這樣可以保持主對話上下文乾淨，同時執行複雜的工作。

## 注意事項

- 命令是作為指示解釋的 markdown 檔案
- `/` 前綴觸發命令執行
- 命令可以生成代理以保留上下文
- 所有 PM 命令（`/pm:*`）在主要 README 中有文件說明
- 命令遵循 `/rules/` 中定義的規則
